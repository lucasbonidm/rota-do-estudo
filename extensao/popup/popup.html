<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=400">
  <link rel="stylesheet" href="popup.css">
  <title>Rota do Estudo</title>
</head>
<body>
  <!-- HEADER -->
  <header class="header">
    <h1>Rota do Estudo</h1>
    <button id="btn-config" class="btn-icon" title="Configuracoes">
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
        <path d="M6.5 1L7.1 3.1a5 5 0 011.8 0L9.5 1h1l.6 2.1a5 5 0 011.3 1.3L14.5 3.8v1l-2.1.6a5 5 0 010 1.8l2.1.6v1l-2.1.6a5 5 0 01-1.3 1.3l.6 2.1h-1l-.6-2.1a5 5 0 01-1.8 0L7.1 13h-1l-.6-2.1a5 5 0 01-1.3-1.3L2.1 10.2v-1l2.1-.6a5 5 0 010-1.8L2.1 6.2v-1l2.1-.6a5 5 0 011.3-1.3L4.9 1.2h1z" stroke="currentColor" stroke-width="1.2"/>
        <circle cx="8" cy="7" r="2" stroke="currentColor" stroke-width="1.2"/>
      </svg>
    </button>
  </header>

  <!-- TELA: Configuracao -->
  <section id="view-config" class="view hidden">
    <p class="label">URL do seu app:</p>
    <input type="url" id="input-app-url" placeholder="https://rota-do-estudo.vercel.app/" />
    <button id="btn-save-url" class="btn btn-primary">Salvar</button>
    <button id="btn-cancel-config" class="btn btn-secondary">Voltar</button>
  </section>

  <!-- TELA: Carregando -->
  <section id="view-loading" class="view">
    <div class="spinner"></div>
    <p>Detectando pagina...</p>
  </section>

  <!-- TELA: Fora do YouTube -->
  <section id="view-none" class="view hidden">
    <div class="empty-state">
      <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
        <rect x="4" y="10" width="40" height="28" rx="4" stroke="currentColor" stroke-width="2"/>
        <polygon points="20,18 32,24 20,30" fill="currentColor"/>
      </svg>
      <p>Abra um video ou playlist no YouTube para comecar.</p>
    </div>
    <button id="btn-open-app-none" class="btn btn-secondary">Abrir App</button>
  </section>

  <!-- TELA: Video Detectado -->
  <section id="view-video" class="view hidden">
    <div class="detected-info">
      <span class="badge badge-video">VIDEO</span>
      <p class="detected-title" id="video-title"></p>
    </div>

    <p class="section-label">O que deseja fazer?</p>

    <!-- Criar novo curso -->
    <div class="action-group">
      <button id="btn-create-video" class="btn btn-primary btn-full">
        Criar novo curso com este video
      </button>
    </div>

    <!-- Campo nome do curso (oculto inicialmente) -->
    <div id="create-video-form" class="form-group hidden">
      <label>Nome do curso:</label>
      <input type="text" id="input-course-name-video" />
      <button id="btn-confirm-create-video" class="btn btn-primary btn-full">Confirmar</button>
      <button id="btn-cancel-create-video" class="btn btn-secondary btn-full">Cancelar</button>
    </div>

    <!-- Adicionar como modulo a um curso -->
    <div class="action-group">
      <button id="btn-add-module-video" class="btn btn-secondary btn-full">
        Adicionar como modulo a um curso
      </button>
    </div>

    <div id="add-module-video-form" class="form-group hidden">
      <label>Selecione o curso:</label>
      <select id="select-course-video"></select>
      <p id="no-courses-video" class="no-courses hidden">Nenhum curso encontrado. Crie um curso primeiro.</p>
      <label>Nome do modulo:</label>
      <input type="text" id="input-module-name-video" />
      <button id="btn-confirm-module-video" class="btn btn-primary btn-full">Confirmar</button>
      <button id="btn-cancel-module-video" class="btn btn-secondary btn-full">Cancelar</button>
    </div>

    <!-- Adicionar video a um modulo existente -->
    <div class="action-group">
      <button id="btn-add-lesson-video" class="btn btn-secondary btn-full">
        Adicionar video a um modulo existente
      </button>
    </div>

    <div id="add-lesson-video-form" class="form-group hidden">
      <label>Selecione o curso:</label>
      <select id="select-lesson-course-video"></select>
      <p id="no-courses-lesson-video" class="no-courses hidden">Nenhum curso encontrado. Crie um curso primeiro.</p>
      <label>Selecione o modulo:</label>
      <select id="select-lesson-module-video"></select>
      <p id="no-modules-lesson-video" class="no-courses hidden">Este curso nao tem modulos.</p>
      <button id="btn-confirm-lesson-video" class="btn btn-primary btn-full">Confirmar</button>
      <button id="btn-cancel-lesson-video" class="btn btn-secondary btn-full">Cancelar</button>
    </div>

    <button id="btn-open-app-video" class="btn btn-secondary btn-full">Abrir App</button>
  </section>

  <!-- TELA: Playlist Detectada -->
  <section id="view-playlist" class="view hidden">
    <div class="detected-info">
      <span class="badge badge-playlist">PLAYLIST</span>
      <p class="detected-title" id="playlist-title"></p>
      <p class="detected-meta" id="playlist-count"></p>
    </div>

    <p class="section-label">O que deseja fazer?</p>

    <!-- Criar novo curso -->
    <div class="action-group">
      <button id="btn-create-playlist" class="btn btn-primary btn-full">
        Criar novo curso com playlist
      </button>
    </div>

    <!-- Campo nome do curso (oculto) -->
    <div id="create-playlist-form" class="form-group hidden">
      <label>Nome do curso:</label>
      <input type="text" id="input-course-name-playlist" />
      <div class="radio-group">
        <label class="radio-label">
          <input type="radio" name="module-mode" value="single" checked />
          Modulo unico (todos os videos juntos)
        </label>
        <label class="radio-label">
          <input type="radio" name="module-mode" value="auto" />
          Detectar modulos automaticamente
        </label>
      </div>
      <button id="btn-confirm-create-playlist" class="btn btn-primary btn-full">Confirmar</button>
      <button id="btn-cancel-create-playlist" class="btn btn-secondary btn-full">Cancelar</button>
    </div>

    <!-- Adicionar como modulo a um curso -->
    <div class="action-group">
      <button id="btn-add-module-playlist" class="btn btn-secondary btn-full">
        Adicionar como modulo a um curso
      </button>
    </div>

    <div id="add-module-playlist-form" class="form-group hidden">
      <label>Selecione o curso:</label>
      <select id="select-course-playlist"></select>
      <p id="no-courses-playlist" class="no-courses hidden">Nenhum curso encontrado. Crie um curso primeiro.</p>
      <label>Nome do modulo:</label>
      <input type="text" id="input-module-name-playlist" />
      <button id="btn-confirm-module-playlist" class="btn btn-primary btn-full">Confirmar</button>
      <button id="btn-cancel-module-playlist" class="btn btn-secondary btn-full">Cancelar</button>
    </div>

    <!-- Adicionar videos a um modulo existente -->
    <div class="action-group">
      <button id="btn-add-lesson-playlist" class="btn btn-secondary btn-full">
        Adicionar videos a um modulo existente
      </button>
    </div>

    <div id="add-lesson-playlist-form" class="form-group hidden">
      <label>Selecione o curso:</label>
      <select id="select-lesson-course-playlist"></select>
      <p id="no-courses-lesson-playlist" class="no-courses hidden">Nenhum curso encontrado. Crie um curso primeiro.</p>
      <label>Selecione o modulo:</label>
      <select id="select-lesson-module-playlist"></select>
      <p id="no-modules-lesson-playlist" class="no-courses hidden">Este curso nao tem modulos.</p>
      <button id="btn-confirm-lesson-playlist" class="btn btn-primary btn-full">Confirmar</button>
      <button id="btn-cancel-lesson-playlist" class="btn btn-secondary btn-full">Cancelar</button>
    </div>

    <button id="btn-open-app-playlist" class="btn btn-secondary btn-full">Abrir App</button>
  </section>

  <!-- TELA: Feedback (sucesso/erro) -->
  <section id="view-feedback" class="view hidden">
    <div id="feedback-content"></div>
    <div class="feedback-actions">
      <button id="btn-open-app-feedback" class="btn btn-primary">Abrir no App</button>
      <button id="btn-close-feedback" class="btn btn-secondary">Fechar</button>
    </div>
  </section>

  <script src="popup.js"></script>
</body>
</html>
